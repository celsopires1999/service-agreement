FROM node:23.3.0-slim

RUN apt update && \
    apt install -y curl gpg gnupg gpg-agent socat docker.io 
    
RUN groupadd -g 989 dockerhost || true && usermod -aG 989 node

COPY .docker/start.sh /
RUN chmod +x start.sh

RUN npx playwright install-deps chromium

USER node

WORKDIR /home/node/app

EXPOSE 3000 

CMD ["/start.sh"]